<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR-приложение с World Tracking</title>
    <!-- Подключаем A-Frame (включает Three.js) -->
    <script src=" https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <!-- Подключаем WebXR polyfill для лучшей совместимости -->
    <script src="https://cdn.jsdelivr.net/npm/webxr-polyfill@latest/build/webxr-polyfill.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <!-- AR-сцена с WebXR -->
    <a-scene xr-mode-ui="enabled: true" device-orientation-permission-ui="enabled: true">
        <!-- Камера для AR -->
        <a-entity camera="active: true" look-controls="enabled: false"></a-entity>
        
        <!-- 3D-модель, которая будет размещена в мире -->
        <a-entity id="myModelEntity" gltf-model="#myModel" scale="0.01 0.01 0.01" position="0 0 -1" visible="true"></a-entity>
        
        <!-- Плоскость для размещения модели (опционально, для лучшего взаимодействия) -->
        <a-plane position="0 0 -1" rotation="-90 0 0" width="2" height="2" color="#ffffff" opacity="0.1" visible="true" id="placementPlane"></a-plane>
    </a-scene>

    <!-- Ассеты -->
    <a-assets>
        <a-asset-item id="myModel" src="ar-sculptures/assets/models/cheburashka.glb"></a-asset-item>
    </a-assets>

    <!-- JavaScript для взаимодействия (размещение модели тапом) -->
    <script>
        // Получаем элементы
        const scene = document.querySelector('a-scene');
        const modelEntity = document.querySelector('#myModelEntity');
        const placementPlane = document.querySelector('#placementPlane');

        // Функция для размещения модели на тач/клик
        function placeModel(event) {
            if (modelEntity.getAttribute('visible') === false) {
                // Получаем позицию из события (для тача или клика)
                const intersection = event.detail.intersection;
                if (intersection) {
                    modelEntity.setAttribute('position', intersection.point);
                    modelEntity.setAttribute('visible', true);
                    placementPlane.setAttribute('visible', false); // Скрываем плоскость после размещения
                }
            }
        }

        // Слушаем событие клика/тача на плоскости
        placementPlane.addEventListener('click', placeModel);

        // Когда сцена готова, показываем плоскость для размещения
        scene.addEventListener('loaded', function() {
            placementPlane.setAttribute('visible', true);
        });
    </script>
</body>
</html>
